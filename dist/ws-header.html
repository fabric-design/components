<!-- inject:global -->
<!-- endinject -->
<template>
    <div class="ws-header">
        <!-- inject:html -->
        <div class="refills-patterns refills-components">
  <header class="navigation" role="banner">
    <div class="navigation-wrapper">
      <content select=".logo">
        <!-- Logo -->
      </content>
      <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">MENU</a>
      <nav role="navigation">
        <ul id="js-navigation-menu" class="navigation-menu show">
          <content select=".nav-link">
            <!-- Additional Items -->
          </content>
          <li class="nav-link more dropdown-menu">
            <a href="javascript:void(0)">
              <span id="selectedLanguageFlag" class="flag"></span>
              <span id="selectedLanguage"></span>
            </a>
            <ul class="submenu" id="languages">
            </ul>
          </li>
          <li class="nav-link" id="loggedInInfo">
          </li>
        </ul>
      </nav>
    </div>
  </header>
</div>
        <!-- endinject -->
    </div>
    <style>
        ws-header > .light-dom {
            display: none;
        }
        /* inject:styles */
        @charset "UTF-8";

.ws-header html {
  box-sizing: border-box;
}

.ws-header *, .ws-header *::after, .ws-header *::before {
  box-sizing: inherit;
}

.ws-header .flag {
  display: inline-block;
  width: 16px;
  height: 11px;
  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAWCAYAAAChWZ5EAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADuUlEQVRIibWVXWjWdRTHP/9nz6KYVG5Ggk4x3NLCUS41bEtZvlCkqwulUClNHNJFgUTtIswmUQoaEolgoxvR0JQIJS8ctCE6kprLlyYbilFT2sqs+f+9ntPF88wRCF38nw4czuH3wvmcL/zOL1FVstiyZYuUmIIIlOVxQXA+oOIB+c/7+UzVAe9TNm16GwARQUSIMRDjaAyEUHTvCTEQgsd7z+HDB7MD5HI5AE539xYKhID3Hucczjqss1g75sYYrDE0v9AElECBauB+EaqLxYNzBO/x1uKtxTmHNwZnDdZafGqwzjIx+NIAvOQt9TFS7z3qHDoarUWtRYxFrCnmBk0t4gzlPpAvBYB6h8YIzqHOo9agziG3AYrFrUXS9DaUeoeWBAAghn937RxqDGLMGEiaos4SjS2cjZ5YCgA/H6hVtEzQKIgXxMfbuQYtRohe0QDiFX0iwXSVQoE60MmCjo+IFFwlIjGgIoiEwvOMEYlaXAOtSpDFJQDAgQYP5bPJ4UgkouJIJIB6VCIqHpWAakQ1oBrABXIjkGSdhEd2PqZ3RxAHWgY2Lcw/vRdyBiSCK4PoCnl5DsQAZXDTQbJrT4fWNtTR1XmJ60MAkSiRd1bP4twHn6AxMuvdN3hzRzfqc4zcMlTX3ENTzzEuP7+SrevmJ1kayFfeN46l/R0saVnBwM8jnPphkKgJNdMqqX28ApxFp1Xy7NxqfIg0PFrFnM49cGgbu45ezKQeQK6jP+XExEUk+w8w/Uo3a5qnMzhoSRLg7AD09pMkcHVYaSnvp67rAMlbbXz+ZR8fvX86OwDAL4N/sHmojqvxIWLbe7RufKSwm/4FaQrA9su7qVjSQN+L62h67gDnfrqJsTYzAH0Dwyqid7YVK1SXL7/jlojqmQvXVVXJ4vkft35M7ewKONsP3oNzY1EEtZawcGFhvHqPOAcxkp8xieNn/qb+ysn/UYHGRg1znxztWVVVY4waYlAfgnafv5ZZgdyGLSfZ0d7DqpbjnL9wA34fxq1/FQAdKXweBVN+faaJzr3fMHlKOy+v/5p5T7dl6x7IGRN4sOou9u1ZytRDO/nzs3ZeG98CUPhInANVnlq4nwknOpiTXKNncSd1c6aChOwAq9fUsKp5BubDVnoXrGHLrXlUjouoQjJzEsnMiagq1Q9XsvqVQ3TNbOSBvXvZ+N1mXl/bmBkgP/jbMJ8u2cCRmgV8v+9bfEgJMbJ2ZQ3HTt1AQ2DpxSG++OoESOTg0U4mTBlP6/ZtXGrdDazKBPAP38BUStCEE90AAAAASUVORK5CYII=");
  background-position: 0 0;
  background-repeat: no-repeat;
}

.ws-header .flag.flag-de {
  background-position: -16px 0;
}

.ws-header .flag.flag-en {
  background-position: 0 -11px;
}

.ws-header header.navigation {
  background-color: #333;
  border-bottom: 1px solid #1a1a1a;
  min-height: 60px;
  width: 100%;
  z-index: 999;
}

.ws-header header.navigation .navigation-wrapper {
  max-width: 1200px;
  margin-left: auto;
  margin-right: auto;
  position: relative;
  z-index: 9999;
}

.ws-header header.navigation .navigation-wrapper::after {
  clear: both;
  content: "";
  display: table;
}

.ws-header header.navigation .navigation-wrapper::after {
  clear: both;
  content: "";
  display: table;
}

.ws-header header.navigation .logo {
  float: left;
  max-height: 60px;
  padding-left: 1em;
  padding-right: 2em;
}

.ws-header header.navigation .navigation-menu-button {
  color: rgba(255, 255, 255, 0.7);
  display: block;
  float: right;
  line-height: 60px;
  margin: 0;
  padding-right: 1em;
  text-decoration: none;
  text-transform: uppercase;
}

@media screen and (min-width: 53.75em) {
  .ws-header header.navigation .navigation-menu-button {
    display: none;
  }
}

.ws-header header.navigation .navigation-menu-button:focus, .ws-header header.navigation .navigation-menu-button:hover {
  color: white;
}

.ws-header header.navigation nav {
  float: none;
  min-height: 60px;
  z-index: 9999999;
}

@media screen and (min-width: 53.75em) {
  .ws-header header.navigation nav {
    float: left;
  }
}

.ws-header header.navigation ul.navigation-menu {
  clear: both;
  display: none;
  margin: 0 auto;
  overflow: visible;
  padding: 0;
  width: 100%;
  z-index: 9999;
}

.ws-header header.navigation ul.navigation-menu.show {
  display: block;
}

@media screen and (min-width: 53.75em) {
  .ws-header header.navigation ul.navigation-menu {
    display: inline;
    margin: 0;
    padding: 0;
  }
}

.ws-header header.navigation ul li.nav-link {
  background: #333;
  display: block;
  line-height: 60px;
  overflow: hidden;
  padding-right: 0.8em;
  text-align: right;
  width: 100%;
  z-index: 9999;
  cursor: pointer;
  color: rgba(255, 255, 255, 0.7);
}

.ws-header header.navigation ul li.nav-link:hover {
  color: white;
}

@media screen and (min-width: 53.75em) {
  .ws-header header.navigation ul li.nav-link {
    background: transparent;
    display: inline;
    line-height: 60px;
    text-decoration: none;
    width: auto;
  }
}

.ws-header header.navigation ul li.nav-link a {
  color: rgba(255, 255, 255, 0.7);
  display: inline-block;
  text-decoration: none;
  box-sizing: content-box;
}

@media screen and (min-width: 53.75em) {
  .ws-header header.navigation ul li.nav-link a {
    padding-right: 1em;
  }
}

.ws-header header.navigation ul li.nav-link a:focus, .ws-header header.navigation ul li.nav-link a:hover {
  color: white;
}

.ws-header header.navigation ul li.nav-link a:after {
  position: relative !important;
}

.ws-header header.navigation li.more.nav-link {
  padding-right: 0;
}

@media screen and (min-width: 53.75em) {
  .ws-header header.navigation li.more.nav-link {
    padding-right: 1em;
  }
}

.ws-header header.navigation li.more.nav-link > ul > li:first-child a {
  padding-top: 1em;
}

.ws-header header.navigation li.more.nav-link a {
  margin-right: 1em;
}

.ws-header header.navigation li.more.nav-link > a {
  padding-right: 0.6em;
}

.ws-header header.navigation li.more.nav-link > a:after {
  position: absolute;
  top: auto;
  right: -0.4em;
  bottom: auto;
  left: auto;
  content: '\25BE';
  color: rgba(255, 255, 255, 0.7);
}

.ws-header header.navigation li.more {
  overflow: visible;
  padding-right: 0;
}

.ws-header header.navigation li.more a {
  padding-right: 0.8em;
}

.ws-header header.navigation li.more > a {
  padding-right: 1.6em;
  position: relative;
}

@media screen and (min-width: 53.75em) {
  .ws-header header.navigation li.more > a {
    margin-right: 1em;
  }
}

.ws-header header.navigation li.more > a:after {
  content: '›';
  font-size: 1.2em;
  position: absolute;
  right: 0.5em;
}

.ws-header header.navigation li.more:focus > .submenu, .ws-header header.navigation li.more:hover > .submenu {
  display: block;
}

@media screen and (min-width: 53.75em) {
  .ws-header header.navigation li.more {
    padding-right: 0.8em;
    position: relative;
  }
}

.ws-header header.navigation .dropdown-menu .flag {
  margin-top: 25px;
}

.ws-header header.navigation ul.submenu {
  display: none;
  padding-left: 0;
}

@media screen and (min-width: 53.75em) {
  .ws-header header.navigation ul.submenu {
    left: -1em;
    position: absolute;
    top: 1.5em;
  }
}

@media screen and (min-width: 53.75em) {
  .ws-header header.navigation ul.submenu .submenu {
    left: 11.8em;
    top: 0;
  }
}

.ws-header header.navigation ul.submenu li {
  display: block;
  padding-right: 0;
}

@media screen and (min-width: 53.75em) {
  .ws-header header.navigation ul.submenu li {
    line-height: 46.15385px;
  }

  .ws-header header.navigation ul.submenu li:first-child > a {
    border-top-left-radius: 3px;
    border-top-right-radius: 3px;
  }

  .ws-header header.navigation ul.submenu li:last-child > a {
    border-bottom-left-radius: 3px;
    border-bottom-right-radius: 3px;
    padding-bottom: 0.7em;
  }
}

.ws-header header.navigation ul.submenu li a {
  background-color: #2b2b2b;
  display: inline-block;
  text-align: right;
  width: 100%;
  padding-top: 0em !important;
}

@media screen and (min-width: 53.75em) {
  .ws-header header.navigation ul.submenu li a {
    background-color: #333;
    padding-left: 1em;
    text-align: left;
    width: 12em;
  }
}

.ws-header header.navigation #loggedInInfo a {
  margin-right: 1em;
}

.ws-header header.navigation #loggedInInfo #logOutButton {
  margin-left: 0.5em;
  width: 1em;
  height: 1em;
  vertical-align: middle;
  zoom: 1.5;
}

.ws-header header.navigation #loggedInInfo #logOutButton #logOutIcon {
  height: 100%;
  background-color: white;
  -webkit-mask-image: url('data:image/svg+xml;utf-8,<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve"><path d="M48.501,27.015c0,0.827,0.671,1.5,1.5,1.5h21.486v42.974H50.001c-0.829,0-1.5,0.672-1.5,1.5c0,0.829,0.671,1.5,1.5,1.5  h22.986c0.828,0,1.5-0.671,1.5-1.5V27.013c0-0.828-0.672-1.5-1.5-1.5H50.001C49.172,25.515,48.501,26.187,48.501,27.015z   M48.473,38.447c0,0.384,0.146,0.768,0.438,1.061l8.964,8.963h-30.86c-0.828,0-1.5,0.671-1.5,1.5c0,0.829,0.672,1.5,1.5,1.5h30.86  l-8.993,8.992c-0.293,0.293-0.439,0.677-0.439,1.062c0,0.383,0.146,0.768,0.439,1.061c0.585,0.586,1.536,0.586,2.121,0  l11.553-11.553c0.141-0.141,0.25-0.308,0.327-0.492c0.003-0.008,0.004-0.016,0.007-0.022c0.067-0.169,0.105-0.354,0.105-0.547  s-0.039-0.378-0.105-0.548c-0.003-0.007-0.004-0.015-0.007-0.021c-0.077-0.187-0.188-0.354-0.328-0.493L51.032,37.386  c-0.585-0.586-1.535-0.586-2.121,0C48.618,37.679,48.473,38.063,48.473,38.447z"></path></svg>');
  mask-image: url('data:image/svg+xml;utf-8,<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve"><path d="M48.501,27.015c0,0.827,0.671,1.5,1.5,1.5h21.486v42.974H50.001c-0.829,0-1.5,0.672-1.5,1.5c0,0.829,0.671,1.5,1.5,1.5  h22.986c0.828,0,1.5-0.671,1.5-1.5V27.013c0-0.828-0.672-1.5-1.5-1.5H50.001C49.172,25.515,48.501,26.187,48.501,27.015z   M48.473,38.447c0,0.384,0.146,0.768,0.438,1.061l8.964,8.963h-30.86c-0.828,0-1.5,0.671-1.5,1.5c0,0.829,0.672,1.5,1.5,1.5h30.86  l-8.993,8.992c-0.293,0.293-0.439,0.677-0.439,1.062c0,0.383,0.146,0.768,0.439,1.061c0.585,0.586,1.536,0.586,2.121,0  l11.553-11.553c0.141-0.141,0.25-0.308,0.327-0.492c0.003-0.008,0.004-0.016,0.007-0.022c0.067-0.169,0.105-0.354,0.105-0.547  s-0.039-0.378-0.105-0.548c-0.003-0.007-0.004-0.015-0.007-0.021c-0.077-0.187-0.188-0.354-0.328-0.493L51.032,37.386  c-0.585-0.586-1.535-0.586-2.121,0C48.618,37.679,48.473,38.063,48.473,38.447z"></path></svg>');
}

.ws-header ::content .logo {
  float: left;
  max-height: 60px;
  margin-left: 1em;
  margin-right: 2em;
  line-height: 60px;
  padding-top: 0;
  background-color: transparent;
  color: #00abf2;
  text-decoration: none;
  transition: color .1s linear;
}

.ws-header ::content .logo img {
  box-sizing: content-box;
  padding: 1.2em 0;
  height: 20px;
}

.ws-header ::content .logo > span {
  display: block;
  float: right;
  margin-left: 10px;
}

.ws-header ::content .logo img {
  padding: 1.2em 0;
}

.ws-header ::content li.nav-link {
  background: transparent;
  display: inline;
  line-height: 60px;
  text-decoration: none;
  width: auto;
}

.ws-header ::content li.nav-link a {
  padding-right: 1em;
  color: rgba(255, 255, 255, 0.7);
  display: inline-block;
  text-decoration: none;
}
        /* endinject */
    </style>
</template>

<script>
(function(){
    /* inject:js */
    'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

//Get the contents of the template (_currentScript is available with webcomponents.js, use currentScript if you don't use this Polyfill)
var template = (document._currentScript || document.currentScript).ownerDocument.querySelector('template');
var availableLanguages = ['de', 'en'];
var state = {
	tokenName: "zalando-internal-access_token",
	stateName: "zalando-internal-access_state",
	languageName: 'language',
	cookiePath: '/',
	cookieDomain: '.zalan.do',
	lang: null,
	loggedIn: null,
	clientId: null,
	redirectUrl: null,
	userServiceUrl: null,
	tokenInfoUrl: null
};
// Remember url at loadtime to not have sideeffects by ie Angular2
var urlAtStart = window.location.href;

var WSHeader = function (_HTMLElement) {
	_inherits(WSHeader, _HTMLElement);

	function WSHeader() {
		_classCallCheck(this, WSHeader);

		return _possibleConstructorReturn(this, Object.getPrototypeOf(WSHeader).apply(this, arguments));
	}

	_createClass(WSHeader, [{
		key: 'createdCallback',

		// Use createdCallback instead of constructor to init an element.
		value: function createdCallback() {
			var _this2 = this;

			var clone = document.importNode(template.content, true);

			// This element uses Shadow DOM.
			applyTemplate(this, clone);
			// this.appendChild(clone);

			this.state = state;
			this.getAttributes();

			this.setupLanguages();

			// would fire initial before

			document.addEventListener("WebComponentsReady", function () {
				var lang = _this2.getLanguage();
				_this2.setLanguage(lang);

				_this2.checkIsLoggedIn().then(function () {
					return _this2.getUser();
				}).then(function () {
					return _this2.showUser();
				}).catch(function (err) {
					var message = "Getting Token-/User-Info failed!";
					if (err) {
						message += " " + err.toString();
					}
					_this2.propagateError(message);
				});
			});
		}
	}, {
		key: 'propagateError',
		value: function propagateError(reason) {
			var event = new CustomEvent("error", {
				detail: {
					message: reason
				}
			});
			this.dispatchEvent(event);
		}
	}, {
		key: 'getAttributes',
		value: function getAttributes() {
			this.state = Object.assign({}, this.state, {
				clientId: this.getAttribute('client-id'),
				redirectUrl: this.getAttribute('redirect-url'),
				userServiceUrl: this.getAttribute('userservice-url'),
				tokenInfoUrl: this.getAttribute('tokeninfo-url')
			});
		}
	}, {
		key: 'setupLanguages',
		value: function setupLanguages() {
			var _this3 = this;

			var languagesElem = this.querySelector('#languages');

			availableLanguages.map(function (lang) {
				var dummy = document.createElement('div');
				dummy.innerHTML = '<li>\n                <a><span class="flag flag-' + lang + '"></span> <span translate="global.language.{{lang}}">' + lang + '</span></a>\n            </li>';
				var node = dummy.childNodes[0];
				node.addEventListener("click", function () {
					return _this3.setLanguage(lang);
				});
				languagesElem.appendChild(node);
			});
		}
	}, {
		key: 'getLanguage',
		value: function getLanguage() {
			return this.state.lang || window.localStorage.getItem(this.state.languageName) || availableLanguages[0];
		}
	}, {
		key: 'setLanguage',
		value: function setLanguage(lang) {
			if (this.state.lang != lang) {
				this.state.lang = lang;
				window.localStorage.setItem(this.state.languageName, lang);
				this.showLanguage(lang);
				this.propagateLanguageChange(lang);
			}
		}
	}, {
		key: 'showLanguage',
		value: function showLanguage(lang) {
			this.querySelector('#selectedLanguageFlag').className = "flag flag-" + lang;
			this.querySelector('#selectedLanguage').innerText = lang;
		}
	}, {
		key: 'propagateLanguageChange',
		value: function propagateLanguageChange(lang) {
			var event = new CustomEvent("language-changed", {
				detail: {
					language: lang
				}
			});
			this.dispatchEvent(event);
		}
	}, {
		key: 'login',
		value: function login() {
			var url = "https://auth.zalando.com/z/oauth2/authorize?realm=/employees&response_type=token&scope=uid" + "&client_id=" + this.state.clientId + "&redirect_uri=" + this.state.redirectUrl + "&state=" + this.setSessionState();

			window.location.href = url;
		}
	}, {
		key: 'logout',
		value: function logout() {
			this.removeCookie();

			this.showLoggedOut();
			this.propagateLoginStatusChange(false);
		}
	}, {
		key: 'checkIsLoggedIn',
		value: function checkIsLoggedIn() {
			var _this4 = this;

			return new Promise(function (resolve, reject) {
				_this4.getToken(urlAtStart).then(function (token) {
					// checking that token is still valid
					_this4.getTokenInfo().then(function () {
						_this4.showLoggedIn();

						_this4.propagateLoginStatusChange(true, token);
						resolve();
					}, function (err) {
						_this4.logout();
						reject(err);
					});
				}, function (err) {
					_this4.logout();
					reject(err);
				});
			});
		}
	}, {
		key: 'propagateLoginStatusChange',
		value: function propagateLoginStatusChange(isLoggedIn, token) {
			if (this.state.loggedIn !== isLoggedIn) {
				this.state.loggedIn = isLoggedIn;

				var event = new CustomEvent("login-status-changed", {
					detail: {
						loggedIn: isLoggedIn,
						token: token || null
					}
				});
				this.dispatchEvent(event);
			}
		}
	}, {
		key: 'showLoggedOut',
		value: function showLoggedOut() {
			var loggedInInfo = this.querySelector('#loggedInInfo');
			loggedInInfo.innerHTML = '<a class="auto-size"><span translate="global.menu.signein">Login</span></i></a>';
			loggedInInfo.removeEventListener("click", this.logout);
			loggedInInfo.addEventListener("click", this.login.bind(this));
		}
	}, {
		key: 'showLoggedIn',
		value: function showLoggedIn() {
			var loggedInInfo = this.querySelector('#loggedInInfo');
			loggedInInfo.innerHTML = '<span translate="global.menu.signedinas"></span>\n\t\t\t<span id="userName">Loading...</span>\n\t\t\t<a class="auto-size" id="logOutButton" type="button"><div id="logOutIcon"></div></a>';
			loggedInInfo.removeEventListener("click", this.login);
			loggedInInfo.addEventListener("click", this.logout.bind(this));
		}
	}, {
		key: 'setSessionState',
		value: function setSessionState() {
			// create new state guid
			var state = this.guid();

			// save the state to check for it on return
			window.localStorage.setItem(this.state.stateName, state);
			return state;
		}
	}, {
		key: 'checkSessionState',
		value: function checkSessionState(state) {
			var valid = window.localStorage.getItem(this.state.stateName) === state;
			window.localStorage.removeItem(this.state.stateName);
			return valid;
		}
	}, {
		key: 'getToken',
		value: function getToken(url) {
			var _this5 = this;

			if (!url) {
				url = window.location.href;
			}
			return new Promise(function (resolve, reject) {
				var token = _this5.getTokenFromUrl(url);
				if (token) {
					var sessionState = _this5.getStateFromUrl(url);
					if (_this5.checkSessionState(sessionState)) {
						_this5.setCookie(token);
						return resolve(token);
					}
				}
				token = _this5.getCookieValue(_this5.state.tokenName);
				if (token) {
					return resolve(token);
				}

				reject();
			});
		}
	}, {
		key: 'getTokenFromUrl',
		value: function getTokenFromUrl(url) {
			var urlQueryTokenPart = /access_token=([^&]+)/.exec(url);
			return urlQueryTokenPart != null ? urlQueryTokenPart[1] : null;
		}
	}, {
		key: 'getStateFromUrl',
		value: function getStateFromUrl(url) {
			var urlQueryStatePart = /state=([^&]+)/.exec(url);
			return urlQueryStatePart[1];
		}
	}, {
		key: 'getTokenInfo',
		value: function getTokenInfo() {
			var _this6 = this;

			return new Promise(function (resolve, reject) {
				_this6.request('GET', _this6.state.tokenInfoUrl).then(function (data) {
					_this6.state = Object.assign({}, _this6.state, {
						userUID: data.uid
					});
					resolve(data.uid);
				}, function (err) {
					_this6.logout();
					reject(err);
				});
			});
		}
	}, {
		key: 'getUser',
		value: function getUser() {
			var _this7 = this;

			return new Promise(function (resolve, reject) {
				_this7.request('GET', _this7.state.userServiceUrl + '?q=' + _this7.state.userUID).then(function (data) {
					var user = data[0];
					if (!user) {
						reject();
					}
					var userInfo = {
						userName: user.name,
						userEmail: user.email
					};
					_this7.state = Object.assign({}, _this7.state, userInfo);
					resolve(userInfo);
				}, function (err) {
					_this7.logout();
					reject(err);
				});
			});
		}
	}, {
		key: 'showUser',
		value: function showUser() {
			this.querySelector('#userName').innerText = this.state.userName;
		}
	}, {
		key: 'setCookie',
		value: function setCookie(token) {
			// setting domain does not work for dev localhost environment
			//document.cookie = `${this.state.tokenName}=${token},path=${this.state.cookiePath};domain=${this.state.cookieDomain};`
			document.cookie = this.state.tokenName + '=' + token + ';path=' + this.state.cookiePath + ';';
		}
	}, {
		key: 'removeCookie',
		value: function removeCookie() {
			document.cookie = this.state.tokenName + '=;path=' + this.state.cookiePath + ';domain=' + this.state.cookieDomain + ';expires=Thu, 01 Jan 1970 00:00:01 GMT";';
		}

		// HELPERS

		// matches a cookie name in the cookie string and returns the last value

	}, {
		key: 'getCookieValue',
		value: function getCookieValue(a) {
			var b = document.cookie.match('(^|;)\\s*' + a + '\\s*=\\s*([^;]+)');
			return b ? b.pop() : '';
		}
	}, {
		key: 'guid',
		value: function guid() {
			function s4() {
				return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
			}
			return '' + s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();
		}

		// Method: 'GET', 'POST'

	}, {
		key: 'request',
		value: function request(method, url) {
			var _this8 = this;

			var headers = new Headers();
			return this.getToken(urlAtStart).then(function (token) {
				headers.append("Authorization", 'Bearer ' + token);
				return Promise.resolve();
			}).then(function () {
				return fetch(url, {
					method: method,
					headers: headers,
					mode: 'cors',
					cache: 'default'
				}).then(_this8.checkStatus).then(function (response) {
					return response.json();
				});
			});
		}
	}, {
		key: 'checkStatus',
		value: function checkStatus(response) {
			if (response.status >= 200 && response.status < 300) {
				return response;
			} else {
				var error = new Error(response.statusText);
				error.response = response;
				throw error;
			}
		}

		// You can also define the other lifecycle methods.

	}, {
		key: 'attachedCallback',
		value: function attachedCallback() {}
	}, {
		key: 'detachedCallback',
		value: function detachedCallback() {}
	}, {
		key: 'attributeChangedCallback',
		value: function attributeChangedCallback(attrName, oldVal, newVal) {
			switch (attrName) {
				case "redirect-url":
				case "client-id":
				case "userservice-url":
					this.getAttributes();
					break;
			}
		}
	}]);

	return WSHeader;
}(HTMLElement);

//Register the element with the document


document.registerElement('ws-header', WSHeader);

function applyTemplate(containerElem, template) {
	'use strict';

	addLightDom(containerElem, template);

	var innerContainerSelector = '.' + containerElem.tagName.toLowerCase();

	var observer = new MutationObserver(function (mutations) {
		var changed = false;
		mutations.forEach(function (mutation) {
			var target = mutation.target;
			if (target === containerElem) {
				return;
			}
			if (target instanceof Text) {
				// text elements have no closest function
				target = target.parentNode;
			}
			// ignore changes inside of pseudo shadow dom
			if (target.closest(innerContainerSelector)) {
				return;
			}

			// console.log('Mutation:', mutation);
			changed = true;
		});

		if (changed) {
			addLightDom(containerElem, containerElem.querySelector(innerContainerSelector));
		}
	});

	// Konfiguration des Observers: alles melden - Änderungen an Daten, Kindelementen und Attributen
	var config = {
		attributes: true,
		childList: true,
		characterData: true,
		subtree: true
	};

	observer.observe(containerElem, config);
}

function addLightDom(containerElem, template) {
	'use strict';

	var innerContainerSelector = '.' + containerElem.tagName.toLowerCase();

	var contentTags = template.querySelectorAll('content');
	Array.from(contentTags).forEach(function (contentTag) {
		contentTag.innerHTML = '';
		var selection = contentTag.getAttribute('select');
		if (selection) {
			var selectedLightDomElems = Array.from(containerElem.querySelectorAll(selection)).filter(function (elem) {
				return !elem.closest(innerContainerSelector);
			});

			selectedLightDomElems.forEach(function (selectedLightDomElem) {
				var clone = selectedLightDomElem.cloneNode(true);
				contentTag.appendChild(selectedLightDomElem.cloneNode(true));
			});
		}
	});

	var lightDom = Array.from(containerElem.children).filter(function (elem) {
		return elem.classList && !elem.classList.contains(innerContainerSelector.substr(1));
	});
	var _iteratorNormalCompletion = true;
	var _didIteratorError = false;
	var _iteratorError = undefined;

	try {
		for (var _iterator = lightDom[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
			var child = _step.value;

			if (!child.classList.contains('light-dom')) {
				child.classList.add('light-dom');
			}
		}
	} catch (err) {
		_didIteratorError = true;
		_iteratorError = err;
	} finally {
		try {
			if (!_iteratorNormalCompletion && _iterator.return) {
				_iterator.return();
			}
		} finally {
			if (_didIteratorError) {
				throw _iteratorError;
			}
		}
	}

	containerElem.appendChild(template);
}
    /* endinject */
})()
</script>
